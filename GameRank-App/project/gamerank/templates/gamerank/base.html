{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% block title %}GameRank{% endblock %}</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-9ndCyUa3Y5hOeYy0YTGnF48O+yQjUp+v4p+7a5QfXvKfTJT1LxRs0t5a+zB8b+4b" crossorigin="anonymous" />
  <link rel="stylesheet" href="{% static 'css/main.css' %}" />
  <link rel="icon" type="image/png" href="{% static 'icons/favicon.png' %}">
  {% block extra_css %}{% endblock %}
  <style>
    #header {
      background-color: #666;
      color: #fff;
      padding: 2rem 0;
      text-align: center;
      position: relative;
    }
    #header .container {
      position: relative;
      z-index: 1;
    }
    .site-logo a {
      color: #fff;
      font-size: 2.5rem;
      font-weight: bold;
      text-decoration: none;
    }
    .user-alias {
      margin-top: 0.5rem;
      font-size: 0.9rem;
    }
    .user-alias a,
    .user-alias .link-button {
      color: #ffd;
      text-decoration: underline;
    }
    .link-button {
      background: none;
      border: none;
      padding: 0;
      font: inherit;
      cursor: pointer;
    }
    #main-nav {
      background-color: #444;
      padding: 0.8rem 0;
      text-align: center;
    }
    #main-nav a {
      color: #ffd;
      text-decoration: none;
      margin: 0 1rem;
      font-weight: bold;
    }
    #main-nav a:hover {
      text-decoration: underline;
    }
    #footer {
      background-color: #666;
      color: #fff;
      padding: 1.5rem 0;
      font-size: 0.9rem;
      text-align: center;
    }
    #footer p {
      margin: 0;
    }
    #footer a {
      color: #ffd;
      text-decoration: underline;
    }
  </style>
</head>
<body style="
  font-family: {{ request.session.font_family|default:'Arial, sans-serif' }};
  font-size: {{ request.session.font_size|default:'16px' }};
">
  <header id="header" class="site-header">
    <div class="container">
      <h1 class="site-logo">
        <a href="{% url 'gamerank:home' %}">GameRank</a>
      </h1>
      <div class="user-alias">
        {% if request.user.is_authenticated %}
          {% with alias=request.session.alias|default:request.user.username %}
            {{ alias }}
          {% endwith %}
          |
          <form action="{% url 'gamerank:logout' %}" method="post" style="display:inline">
            {% csrf_token %}
            <button type="submit" class="link-button">Cerrar sesi贸n</button>
          </form>
        {% else %}
          An贸nimo |
          <a href="{% url 'gamerank:login' %}">Iniciar sesi贸n</a> |
          <a href="{% url 'gamerank:register' %}">Registrarse</a>
        {% endif %}
      </div>
    </div>
  </header>

  <nav id="main-nav" class="site-nav">
    <div class="container">
      {% with current=request.resolver_match.url_name %}
        {% if current != 'home' %}
          <a href="{% url 'gamerank:home' %}">Home</a>
        {% endif %}
        {% if current != 'all_games' %}
          <a href="{% url 'gamerank:all_games' %}">Todos los Juegos</a>
        {% endif %}
        {% if request.user.is_authenticated %}
          {% if current != 'user_profile' %}
            <a href="{% url 'gamerank:user_profile' %}">{{ request.user.username }}</a>
          {% endif %}
          {% if current != 'user_votes' %}
            <a href="{% url 'gamerank:user_votes' %}">Juegos votados</a>
          {% endif %}
          {% if current != 'user_followed' %}
            <a href="{% url 'gamerank:user_followed' %}">Juegos seguidos</a>
          {% endif %}
        {% endif %}
        {% if current != 'settings' %}
          <a href="{% url 'gamerank:settings' %}">Configuraci贸n</a>
        {% endif %}
        {% if current != 'help' %}
          <a href="{% url 'gamerank:help' %}">Ayuda</a>
        {% endif %}
        {% if request.user.is_superuser %}
          {% if current != 'admin:index' %}
            <a href="{% url 'admin:index' %}">Admin</a>
          {% endif %}
        {% endif %}
      {% endwith %}
    </div>
  </nav>

  <main id="main-content" class="site-content container">
    {% if messages %}
      <ul class="messages">
        {% for msg in messages %}
          <li class="message {{ msg.tags }}">{{ msg }}</li>
        {% endfor %}
      </ul>
    {% endif %}
    {% block content %}{% endblock %}
  </main>

  <footer id="footer" class="site-footer">
    <div class="container">
      <p>
        Juegos: {{ total_games }}.
        Comentarios: {{ total_comments }}.
        {% if request.user.is_authenticated %}
          Juegos votados por el usuario: {{ user_games_voted }}.
          Comentarios por el usuario: {{ user_comments_count }}.
        {% endif %}
      </p>
    </div>
  </footer>

  <script src="{% static 'js/main.js' %}"></script>
  {% block extra_js %}{% endblock %}
  <script src="https://unpkg.com/htmx.org@1.9.2"></script>
</body>
</html>
